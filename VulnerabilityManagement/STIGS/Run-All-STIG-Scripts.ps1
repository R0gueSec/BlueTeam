<#
.SYNOPSIS
    Executes all STIG remediation PowerShell scripts in the current directory and logs the output.

.NOTES
    Author          : RogueSec
    Website         : www.roguesec.net
    GitHub          : github.com/R0gueSec
    Date Created    : 2025-07-06
    Last Modified   : 2025-07-06
    Version         : 1.0

.USAGE
    Run this script as Administrator in the folder containing the STIG scripts.
    PS C:\> .\Run-All-STIG-Scripts.ps1
#>

$log = "execution_log.txt"
Get-ChildItem -Filter "*.ps1" | Where-Object { $_.Name -ne "Run-All-STIG-Scripts.ps1" } | ForEach-Object {
    $script = $_.FullName
    Add-Content $log "[2025-07-06 $(Get-Date -Format HH:mm:ss)] Running $($_.Name)"
    try {
        . $script
        Add-Content $log "[2025-07-06 $(Get-Date -Format HH:mm:ss)] Completed $($_.Name)`n"
    } catch {
        Add-Content $log "[2025-07-06 $(Get-Date -Format HH:mm:ss)] ERROR in $($_.Name): $_`n"
    }
}
