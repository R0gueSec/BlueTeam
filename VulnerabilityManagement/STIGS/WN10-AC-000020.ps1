<#
.SYNOPSIS
    Enforces 24 password history.
.NOTES
    Author          : RogueSec
    Website         : www.roguesec.net
    GitHub          : github.com/R0gueSec
    Date Created    : 2025-07-06
    Last Modified   : 2025-07-06
    Version         : 1.1
    STIG-ID         : WN10-AC-000020
.TESTED ON
    Date(s) Tested  : 2025-07-06
    Tested By       : RogueSec
    Systems Tested  : Windows 10 22H2
    PowerShell Ver. : 5.1
.USAGE
    PS C:\> .\WN10-AC-000020.ps1
#>
secedit /export /cfg C:\secpol.cfg
(Get-Content C:\secpol.cfg) -replace "^PasswordHistorySize\s*=.*", "PasswordHistorySize = 24" | Set-Content C:\secpol.cfg
secedit /configure /db secedit.sdb /cfg C:\secpol.cfg /areas SECURITYPOLICY
Remove-Item C:\secpol.cfg -Force
